<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>Flash Properties</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta content="noindex, nofollow" name="robots">
		<script src="../../dialog/common/fck_dialog_common.js" type="text/javascript"></script>
		<link href="../../dialog/common/fck_dialog_common.css" rel="stylesheet" type="text/css" />
		<script language="javascript">

var oEditor = window.parent.InnerDialogLoaded() ;
var FCKLang = oEditor.FCKLang ;
var FCK		= oEditor.FCK ;
var oFlashOriginal ;


// Get the selected Flash (if available).
var oFlash = FCK.Selection.GetSelectedElement() ;

if ( oFlash && (oFlash.tagName != 'EMBED' || oFlash.opentest_type != oEditor.FCKConfig.FlashOType))
	oFlash = null ;

window.onload = function ()
{
	// First of all, translate the dialog box texts
	oEditor.FCKLanguageManager.TranslatePage( document ) ;

	var oObj = document.createElement( 'EMBED' );
	oObj.id='flashPreview';
	oObj.type=oEditor.FCKConfig.FlashType;
    oObj.style.display = 'none';	
	//GetE('flshPrv').appendChild(oObj);
	//GetE('flshPrv').innerHTML=oObj.outerHTML;
	//alert(oObj);
	if  (navigator.appName == "Microsoft Internet Explorer")
		GetE('flshPrv').innerHTML=oObj.outerHTML;
	else
		GetE('flshPrv').appendChild(oObj);	
	

	// Load the selected element information (if any).
	LoadSelection() ;

	// Show/Hide the "Browse Server" button.
	GetE('tdBrowse').style.display = oEditor.FCKConfig.FlashBrowser ? '' : 'none' ;

	//UpdateOriginal() ;

	window.parent.SetAutoSize( true ) ;

	// Activate the "OK" button.
	window.parent.SetOkButton( true ) ;
}

function LoadSelection()
{
	if ( ! oFlash ) return ;

	var sUrl = oFlash.src ;

	GetE('txtUrl').value    = sUrl ;
	GetE('cmbAlign').value	= GetAttribute( oFlash, 'align', '' ) ;
/*	GetE('txtAlt').value    = GetAttribute( oFlash, 'alt', '' ) ;
	GetE('txtVSpace').value	= GetAttribute( oFlash, 'vspace', '' ) ;
	GetE('txtHSpace').value	= GetAttribute( oFlash, 'hspace', '' ) ;
	GetE('txtBorder').value	= GetAttribute( oFlash, 'border', '' ) ;
	GetE('txtAttTitle').value		= oFlash.title ;*/

	if ( oFlash.style.pixelWidth > 0 )
		GetE('txtWidth').value  = oFlash.style.pixelWidth ;
	else
		GetE('txtWidth').value  = GetAttribute( oFlash, "width", '' ) ;

	if ( oFlash.style.pixelHeight > 0 )
		GetE('txtHeight').value  = oFlash.style.pixelHeight ;
	else
		GetE('txtHeight').value = GetAttribute( oFlash, "height", '' ) ;


	UpdatePreview() ;
}

function Ok()
{
	if ( GetE('txtUrl').value.length == 0 )
	{
		GetE('txtUrl').focus() ;

		alert( oEditor.FCKLang.FlashErrUrl ) ;

		return false ;
	}

	if ( !oFlash )
	{
		oFlash = FCK.EditorDocument.createElement( 'EMBED' ) ;
		oFlash.type=oEditor.FCKConfig.FlashType;
		SetAttribute( oFlash, "pluginspage"   , oEditor.FCKConfig.FlashPlugin ) ;
		oFlash.opentest_type = oEditor.FCKConfig.FlashOType;
		UpdateFlash( oFlash ) ;
		FCK.InsertElement(oFlash);
	}
	else
		UpdateFlash( oFlash ) ;

	return true ;
}

function BrowseServer()
{
	// Set the browser window feature.
	var iWidth	= oEditor.FCKConfig.FlashBrowserWindowWidth ;
	var iHeight	= oEditor.FCKConfig.FlashBrowserWindowHeight ;

	var iLeft = (screen.width  - iWidth) / 2 ;
	var iTop  = (screen.height - iHeight) / 2 ;

	var sOptions = "toolbar=no,status=no,resizable=yes,dependent=yes" ;
	sOptions += ",width=" + iWidth ;
	sOptions += ",height=" + iHeight ;
	sOptions += ",left=" + iLeft ;
	sOptions += ",top=" + iTop ;

	// Open the browser window.
	var oWindow = window.open( oEditor.FCKConfig.FlashBrowserURL, "FCKBrowseWindow", sOptions ) ;
}

function SetUrl( url, width, height, alt )
{
	GetE('txtUrl').value = oEditor.FCKConfig.BaseHref+url ;	
	GetE('txtWidth').value = width ? width : '150' ;
	GetE('txtHeight').value = height ? height : '150' ;

	if ( alt )
	{
		GetE('txtAlt').value = alt;
		GetE('txtTitle').value = alt;
	}

	UpdatePreview() ;
//	UpdateOriginal( true ) ;
}

function UpdateOriginal( resetSize )
{
	oFlashOriginal = document.createElement( 'EMBED' ) ;	// new Flash() ;

	if ( resetSize )
	{
		oFlashOriginal.onload = function()
		{
			this.onload = null ;
			ResetSizes() ;
		}
	}

	oFlashOriginal.type=oEditor.FCKConfig.FlashType;
    SetAttribute( oFlashOriginal, "pluginspage"  , oEditor.FCKConfig.FlashPlugin ) ;
	oFlashOriginal.movie = GetE('flashPreview').movie;
}

function UpdatePreview()
{
	if ( GetE('txtUrl').value.length == 0 )
		GetE('flashPreview').style.display = 'none' ;
	else
    {
		UpdateFlash( GetE('flashPreview')) ;
        GetE('flashPreview').movie=GetE('flashPreview').src;
        GetE('flashPreview').style.display = '' ;
    }

}

function UpdateFlash( e )
{
	e.src = GetE('txtUrl').value ;
	SetAttribute( e, "width" , GetE('txtWidth').value ) ;
	SetAttribute( e, "height", GetE('txtHeight').value ) ;
	SetAttribute( e, "align" , GetE('cmbAlign').value ) ;

/*	SetAttribute( e, "alt"   , GetE('txtAlt').value ) ;
	SetAttribute( e, 'title'	, GetE('txtAttTitle').value ) ;
	SetAttribute( e, "vspace", GetE('txtVSpace').value ) ;
	SetAttribute( e, "hspace", GetE('txtHSpace').value ) ;
	SetAttribute( e, "border", GetE('txtBorder').value ) ;*/

}

		</script>
	</head>
	<body scroll="no" style="OVERFLOW: hidden">
		<table height="100%" cellSpacing="0" cellPadding="0" width="100%" border="0">
		   <tr>
			   <td>
				   <table cellspacing="5" cellpadding="0" width="100%" border="0">
					  <tr>
						  <td width="100%">
							  <span fckLang="FlashDlgURL">URL</span>
						  </td>
						  <td id="tdBrowse" style="DISPLAY: none" nowrap rowspan="2" valign="bottom">
							  &nbsp;
							  <input id="btnBrowse" onclick="BrowseServer();" type="button"
								  value="Browse Server" fckLang="DlgBtnBrowseServer" NAME="btnBrowse">
						  </td>
					  </tr>
					  <tr>
						  <td valign="top">
							 <input id="txtUrl" style="WIDTH: 100%" type="text" onblur="UpdatePreview();">
						  </td>
					  </tr>
					  <!--
					  <tr>
						  <td>
							  <span fckLang="FlashDlgAlt">Short Description</span><br>
							  <input id="txtAlt" style="WIDTH: 100%" type="text"><br>
						  </td>
						  <td>
							  <span fckLang="FlashDlgAttTitle">Title</span><br>
							  <input id="txtAttTitle" style="WIDTH: 100%" type="text"><br>
						  </td>
					  </tr>
					  -->
					  <tr height="100%">
							<td valign="top" colspan="2">
								<table cellspacing="0" cellpadding="0" width="100%" border="0" height="100%">
									<tr>
										<td valign="top">
											<br>
											<table cellspacing="0" cellpadding="0" border="0">
												<tr>
													<td nowrap><span fckLang="FlashDlgWidth">Width</span>&nbsp;</td>
													<td>
														<input type="text" size="3" id="txtWidth" onkeyup="UpdatePreview() ;"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="FlashDlgHeight">Height</span>&nbsp;</td>
													<td>
														<input type="text" size="3" id="txtHeight" onkeyup="UpdatePreview() ;"></td>
												</tr>
											</table>

											<br>
											<table cellspacing="0" cellpadding="0" border="0">
												<!--
												<tr>
													<td nowrap><span fckLang="FlashDlgBorder">Border</span>&nbsp;</td>
													<td>
														<input type="text" size="2" value="" id="txtBorder" onkeyup="UpdatePreview();"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="FlashDlgHSpace">HSpace</span>&nbsp;</td>
													<td>
														<input type="text" size="2" id="txtHSpace" onkeyup="UpdatePreview();"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="FlashDlgVSpace">VSpace</span>&nbsp;</td>
													<td>
														<input type="text" size="2" id="txtVSpace" onkeyup="UpdatePreview();"></td>
												</tr>
												-->
												<tr>
													<td nowrap><span fckLang="FlashDlgAlign">Align</span>&nbsp;<br>
													<select id="cmbAlign" onchange="UpdatePreview();">
															<option value="" selected></option>
															<option fckLang="FlashDlgAlignLeft" value="left">Left</option>
															<option fckLang="FlashDlgAlignAbsBottom" value="absBottom">Abs Bottom</option>
															<option fckLang="FlashDlgAlignAbsMiddle" value="absMiddle">Abs Middle</option>
															<option fckLang="FlashDlgAlignBaseline" value="baseline">Baseline</option>
															<option fckLang="FlashDlgAlignBottom" value="bottom">Bottom</option>
															<option fckLang="FlashDlgAlignMiddle" value="middle">Middle</option>
															<option fckLang="FlashDlgAlignRight" value="right">Right</option>
															<option fckLang="FlashDlgAlignTextTop" value="textTop">Text Top</option>
															<option fckLang="FlashDlgAlignTop" value="top">Top</option>
														</select>
													</td>
												</tr>
											</table>
										</td>
										<td>&nbsp;&nbsp;&nbsp;</td>
										<td width="100%" valign="top">
											<table cellpadding="0" cellspacing="0" width="100%" style="TABLE-LAYOUT: fixed">
												<tr>
													<td><span fckLang="FlashDlgPreview">Preview</span></td>
												</tr>
												<tr>
													<td valign="top">
														<div class="ImagePreviewArea" id="flshPrv">
														</div>
													</td>
												</tr>
											</table>
										</td>
									</tr>
								</table>
							</td>
						</tr>
				   </table>
			   </td>
		   </tr>
		</table>
	</body>
</html>