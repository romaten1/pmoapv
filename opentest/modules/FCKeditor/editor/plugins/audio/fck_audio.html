<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>Audio Properties</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta content="noindex, nofollow" name="robots">
		<script src="../../dialog/common/fck_dialog_common.js" type="text/javascript"></script>
		<link href="../../dialog/common/fck_dialog_common.css" rel="stylesheet" type="text/css" />
		<script language="javascript">

var oEditor = window.parent.InnerDialogLoaded() ;
var FCKLang = oEditor.FCKLang ;
var FCK		= oEditor.FCK ;
var oAudioOriginal ;

// Get the selected Audio (if available).
var oAudio = FCK.Selection.GetSelectedElement() ;

if ( oAudio && (oAudio.tagName != 'EMBED' || oAudio.opentest_type != oEditor.FCKConfig.AudioOType))
{	
	oAudio = null ;
}
	
window.onload = function ()
{
	// First of all, translate the dialog box texts
	oEditor.FCKLanguageManager.TranslatePage( document ) ;

	var oObj = document.createElement( 'EMBED' );
	oObj.id='audioPreview';
	oObj.type=oEditor.FCKConfig.AudioType;
    oObj.style.display = 'none';	
	//GetE('flshPrv').appendChild(oObj);
	//GetE('audPrv').innerHTML=oObj.outerHTML;
	if  (navigator.appName == "Microsoft Internet Explorer")
		GetE('audPrv').innerHTML=oObj.outerHTML;
	else
		GetE('audPrv').appendChild(oObj);	


	// Load the selected element information (if any).
	LoadSelection() ;

	// Show/Hide the "Browse Server" button.
	GetE('tdBrowse').style.display = oEditor.FCKConfig.AudioBrowser ? '' : 'none' ;

//	UpdateOriginal() ;

	window.parent.SetAutoSize( true ) ;

	// Activate the "OK" button.
	window.parent.SetOkButton( true ) ;
}

function LoadSelection()
{
	if ( ! oAudio ) return ;

	var sUrl = oAudio.src ;

	GetE('txtUrl').value    = sUrl ;
	GetE('cmbAlign').value	= GetAttribute( oAudio, 'align', '' ) ;

	/*GetE('txtAlt').value    = GetAttribute( oAudio, 'alt', '' ) ;
	GetE('txtVSpace').value	= GetAttribute( oAudio, 'vspace', '' ) ;
	GetE('txtHSpace').value	= GetAttribute( oAudio, 'hspace', '' ) ;
	GetE('txtBorder').value	= GetAttribute( oAudio, 'border', '' ) ;
	GetE('txtAttTitle').value		= oAudio.title ;*/

	if ( oAudio.style.pixelWidth > 0 )
		GetE('txtWidth').value  = oAudio.style.pixelWidth ;
	else
		GetE('txtWidth').value  = GetAttribute( oAudio, "width", '' ) ;

	if ( oAudio.style.pixelHeight > 0 )
		GetE('txtHeight').value  = oAudio.style.pixelHeight ;
	else
		GetE('txtHeight').value = GetAttribute( oAudio, "height", '' ) ;

	UpdatePreview() ;
}

function Ok()
{
	if ( GetE('txtUrl').value.length == 0 )
	{
		GetE('txtUrl').focus() ;
		return false ;
	}

	if ( oAudio )
	{
		oAudio.removeNode();
	}
	oAudio = FCK.EditorDocument.createElement( 'EMBED' ) ;
	oAudio.type=oEditor.FCKConfig.AudioType;
	SetAttribute(oAudio,"pluginspage",oEditor.FCKConfig.AudioPlugin);
	UpdateAudio( oAudio ) ;
	oAudio.src = GetE('txtUrl').value;
	oAudio.removeAttribute('filename');
	
	//oAudio.id=oEditor.FCKConfig.AudioID;
	oAudio.opentest_type = oEditor.FCKConfig.AudioOType;		
	FCK.InsertElement(oAudio);

	return true ;
}

function BrowseServer()
{
	// Set the browser window feature.
	var iWidth	= oEditor.FCKConfig.AudioBrowserWindowWidth ;
	var iHeight	= oEditor.FCKConfig.AudioBrowserWindowHeight ;

	var iLeft = (screen.width  - iWidth) / 2 ;
	var iTop  = (screen.height - iHeight) / 2 ;

	var sOptions = "toolbar=no,status=no,resizable=yes,dependent=yes" ;
	sOptions += ",width=" + iWidth ;
	sOptions += ",height=" + iHeight ;
	sOptions += ",left=" + iLeft ;
	sOptions += ",top=" + iTop ;

	// Open the browser window.
	var oWindow = window.open( oEditor.FCKConfig.AudioBrowserURL, "FCKBrowseWindow", sOptions ) ;
}

function SetUrl( url, width, height, alt )
{
	GetE('txtUrl').value = oEditor.FCKConfig.BaseHref+url ;
	GetE('txtWidth').value = width ? width : '100' ;
	GetE('txtHeight').value = height ? height : '45' ;

	if ( alt )
	{
		GetE('txtAlt').value = alt;
		GetE('txtTitle').value = alt;
	}

	UpdatePreview() ;
//	UpdateOriginal( true ) ;
}

function UpdateOriginal( resetSize )
{
	oAudioOriginal = document.createElement( 'EMBED' ) ;	// new Audio() ;

	if ( resetSize )
	{
		oAudioOriginal.onload = function()
		{
			this.onload = null ;
			ResetSizes() ;
		}
	}

	oAudioOriginal.type=oEditor.FCKConfig.AudioType;
    SetAttribute(oAudioOriginal,"pluginspage",oEditor.FCKConfig.AudioPlugin);
	oAudioOriginal.src = GetE('audioPreview').src;
}

function UpdatePreview()
{
    var audPrev = GetE('audioPreview');
    if ( GetE('txtUrl').value.length == 0 )
		audPrev.style.display = 'none' ;
	else
    {
		if(oAudio)
			audPrev.removeAttribute('filename');		
		UpdateAudio(audPrev) ;		
        audPrev.style.width='';
        audPrev.style.height='';
        audPrev.style.display = '' ;
    }
}

function UpdateAudio( e )
{
    e.autostart = 0;
	
	SetAttribute( e, "filename"		   , GetE('txtUrl').value ) ;	
	SetAttribute( e, "width"		   , GetE('txtWidth').value ) ;
	SetAttribute( e, "height"		   , GetE('txtHeight').value ) ;
	SetAttribute( e, "align"		   , GetE('cmbAlign').value ) ;	

/*	SetAttribute( e, "alt"     , GetE('txtAlt').value ) ;
	SetAttribute( e, "vspace"  , GetE('txtVSpace').value ) ;
	SetAttribute( e, "hspace"  , GetE('txtHSpace').value ) ;
	SetAttribute( e, "border"  , GetE('txtBorder').value ) ;
	SetAttribute( e, "title"   , GetE('txtAttTitle').value ) ;*/
}

		</script>
	</head>
	<body scroll="no" style="OVERFLOW: hidden">
		<table height="100%" cellSpacing="0" cellPadding="0" width="100%" border="0">
		   <tr>
			   <td>
				   <table cellspacing="5" cellpadding="0" width="100%" border="0">
					  <tr>
						  <td width="100%">
							  <span fckLang="AudioDlgURL">URL</span>
						  </td>
						  <td id="tdBrowse" style="DISPLAY: none" nowrap rowspan="2" valign="bottom">
							  &nbsp;
							  <input id="btnBrowse" onclick="BrowseServer();" type="button"
								  value="Browse Server" fckLang="DlgBtnBrowseServer" NAME="btnBrowse">
						  </td>
					  </tr>
					  <tr>
						  <td valign="top">
							 <input id="txtUrl" style="WIDTH: 100%" type="text" onblur="UpdatePreview();">
						  </td>
					  </tr>
					  <!--
					  <tr>
						  <td>
							  <span fckLang="AudioDlgAlt">Short Description</span><br>
							  <input id="txtAlt" style="WIDTH: 100%" type="text"><br>
						  </td>
						  <td>
							  <span fckLang="AudioDlgAttTitle">Title</span><br>
							  <input id="txtAttTitle" style="WIDTH: 100%" type="text"><br>
						  </td>
					  </tr>
					  -->
					  <tr height="100%">
							<td valign="top" colspan="2">
								<table cellspacing="0" cellpadding="0" width="100%" border="0" height="100%">
									<tr>
										<td valign="top">
											<br>
											<table cellspacing="0" cellpadding="0" border="0">
												<tr>
													<td nowrap><span fckLang="AudioDlgWidth">Width</span>&nbsp;</td>
													<td>
														<input type="text" size="3" id="txtWidth" onkeyup="UpdatePreview() ;"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="AudioDlgHeight">Height</span>&nbsp;</td>
													<td>
														<input type="text" size="3" id="txtHeight" onkeyup="UpdatePreview() ;"></td>
												</tr>
											</table>
											<br>
											<table cellspacing="0" cellpadding="0" border="0">
												<!--
												<tr>
													<td nowrap><span fckLang="AudioDlgBorder">Border</span>&nbsp;</td>
													<td>
														<input type="text" size="2" value="" id="txtBorder" onkeyup="UpdatePreview();"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="AudioDlgHSpace">HSpace</span>&nbsp;</td>
													<td>
														<input type="text" size="2" id="txtHSpace" onkeyup="UpdatePreview();"></td>
												</tr>
												<tr>
													<td nowrap><span fckLang="AudioDlgVSpace">VSpace</span>&nbsp;</td>
													<td>
														<input type="text" size="2" id="txtVSpace" onkeyup="UpdatePreview();"></td>
												</tr>
												-->
												<tr>
													<td nowrap><span fckLang="AudioDlgAlign">Align</span><br>
													<select id="cmbAlign" onchange="UpdatePreview();">
															<option value="" selected></option>
															<option fckLang="AudioDlgAlignLeft" value="left">Left</option>
															<option fckLang="AudioDlgAlignAbsBottom" value="absBottom">Abs Bottom</option>
															<option fckLang="AudioDlgAlignAbsMiddle" value="absMiddle">Abs Middle</option>
															<option fckLang="AudioDlgAlignBaseline" value="baseline">Baseline</option>
															<option fckLang="AudioDlgAlignBottom" value="bottom">Bottom</option>
															<option fckLang="AudioDlgAlignMiddle" value="middle">Middle</option>
															<option fckLang="AudioDlgAlignRight" value="right">Right</option>
															<option fckLang="AudioDlgAlignTextTop" value="textTop">Text Top</option>
															<option fckLang="AudioDlgAlignTop" value="top">Top</option>
														</select>
													</td>
												</tr>
											</table>
										</td>
										<td>&nbsp;&nbsp;&nbsp;</td>
										<td width="100%" valign="top">
											<table cellpadding="0" cellspacing="0" width="100%" style="TABLE-LAYOUT: fixed">
												<tr>
													<td><span fckLang="AudioDlgPreview">Preview</span></td>
												</tr>
												<tr>
													<td valign="top">
														<div class="ImagePreviewArea" id="audPrv">
														</div>
													</td>
												</tr>
											</table>
										</td>
									</tr>
								</table>
							</td>
						</tr>
				   </table>
			   </td>
		   </tr>
		</table>
	</body>
</html>